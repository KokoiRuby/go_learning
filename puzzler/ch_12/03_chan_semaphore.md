通道信号量模式 semaphore 是一种常见的并发编程模式，用于**控制并发访问共享资源的数量**。

1. 创建一个**带缓冲通道**，并初始化其容量为允许的最大并发数。这个**通道将用作信号量**。初始化通道后就塞满。

```go
sem := make(chan struct{}, maxConcurrency)
sem <- struct{}{}
sem <- struct{}{}
sem <- struct{}{}
```

2. 在需要访问共享资源的协程中，**首先尝试从信号量通道中接收一个值 = 每次访问，信号量--**

- 如果通道中有可用的值，则可以继续执行
- **如果通道为空，则协程会阻塞等待 = 信号量为 0 则阻塞。**

3. 当协程完成对共享资源的**访问后，再向信号量通道发送一个值 = 信号量++**，以释放资源并通知其他等待的协程可以继续执行。

```go
<-sem // recv from chan, semaphore--
// TODO
sem <- struct{}{} // send to chan, semaphore++
```

